# AutoShark
Автоматизированная система анализа дампов сетевого трафика

Установка:
1. Установите Python 3.6+ и pip
2. Запустите файл install.sh, если у вас UNIX система или install.ps1, если у вас Windows(требуется права администратора)
3. Из директории с проектом запустите от прав администратора ```python setup.py install```(при наличии на компютере нескольких версий Python, к слову python допишите версию, например ```python3.6 setup.py install```)

**Не удаляйте папку с проектом, она нужна для работы программы**

Принятие согласия на установку:
1. Внимательно прочитайте файл AGGREEMENT
2. Запишите в файл permision.txt слово 'да' в указаном месте

**В случае отказа от согласия уберите слово 'да' из файла permision.txt или удалите файл permision.txt вовсе**

### Инструкция по снятию собственного дампа:
При помощи файла ```make_pcap.py``` с запуском от имяни администратора вы сможете снять дамп трафика с указаного вами интерфейса 

### Инструкция по написанию собственных правил yara:
Анализирую дамп трафика вы можите писать правила yara для анализа траффика на интересующие вас свойства. Эти свойства вы можите выделять из полного текста пакетов. Например, если вы хотите обноружить, есть ли в дапме определённый ip адрес:
```
rule detect_specific_ip { # Название правила
    meta:
        description = "Detect specific IP address in pcap files" # Описание правила
    strings:
        $ip_address = "xxx.xxx.xxx.xxx" # Сама строка которую вы будете искать
    condition:
        $ip_address
}
```
 Также вы можете взять готовые yara правила из официального репозитория YARA (https://github.com/Yara-Rules/rules)

## Удачи в анализе траффика

PS. Документация представленна ввиде флага -h(--help) в продукте:
```
-h, --help                Показывает эту документацию.
  -l, --list                Печатает на экран всю информацию обо пакетах.
  -s, --short-list          Печатает на экран краткую информацию обо всех
                            пакетах.
  -p, --packet INTEGER      Выводит всю информацию о выбранном пакете. Список
                            протоколов совпадает с списком из tshark.
  --len-graph               Открывает окно с графиком по длине пакетов.
  --conversations-graph     Открывает окно с картой по общению между адресами
  -c, --conversations TEXT  Выводит статистику об общении между адресами в
                            выбранном протоколе. Список протоколов совпадает с
                            списком из tshark.
  --endpoints TEXT          Показывает статистику о конечных адресатах в
                            выбранном протоколе. Список протоколов совпадает с
                            списком из tshark.
  -f, --files               Экспортирует все файлы в дампе, передоваемые в
                            открытом виде. Список протоколов совпадает с
                            списком из tshark.
  --streams INTEGER         Показывает потоки пакетов по указаному протоколу и
                            позволяет интерактивно их листать. Список
                            протоколов и типов вывода совпадает с списком из
                            tshark.
  --filter TEXT             Фильтрует пакеты по указанному фильтру.
  -a, --autoanalyze PATH    Автоматический анализ при помощи правил yara из
                            выбранного файла.
  -e, --extract PATH        Экпортирует вывод/фото в указанный файл,
                            перезаписывая его.
```

PSS. Для UNIX систем предствавлена установка через пакетный менеджер ```apt```. При необходимости поменяйте пакетный менеджер на ваш.
